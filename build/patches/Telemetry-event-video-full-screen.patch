From: Yifeng <wuyifeng@nd.com.cn>
Date: Wed, 29 Dec 2021 05:40:00 +0000
Subject: AP9-3128 Implement telemetry events for AP9 and AP9 Premium Chromium App

KPI: When users are watching video within the Chromium Browser are they viewing the video in full screen mode?
Event/Trigger: Chromium Video Player Full Screen Mode
Event Display Name: Chromium Video Player Full Screen Mode
Event Description: Video Player in Chromium set to full screen mode
Property Type: Event
Property Name: Video Player in Chromium Full Screen Mode
Property Value: Full screen mode selected in browser video player
Event Tags: AP9, Panel Telemetry, Applications, Chromium
Jira Ticket: https://prometheanworld.atlassian.net/browse/AP9-3128

---
 base/android/java/src/org/chromium/base/TelemetryUtils.java | 15 +++++++++++++++
 chrome/android/java/src/org/chromium/chrome/browser/fullscreen/FullscreenHtmlApiHandler.java | 3 +++
 2 files changed, 18 insertions(+), 0 deletion(-)

diff --git a/base/android/java/src/org/chromium/base/TelemetryUtils.java b/base/android/java/src/org/chromium/base/TelemetryUtils.java
--- a/base/android/java/src/org/chromium/base/TelemetryUtils.java
+++ b/base/android/java/src/org/chromium/base/TelemetryUtils.java
@@ -12,6 +12,12 @@ import org.json.JSONObject;

 public class TelemetryUtils {

+    private static final String EVENT_VIDEO_FULL_SCREEN = "Chromium Video Player Full Screen Mode";
+
+    private static final String KEY_VIDEO_FULL_SCREEN = "Video Player in Chromium Full Screen Mode";
+
+    private static final String VALUE_VIDEO_FULL_SCREEN = "Full screen mode selected in browser video player";
+
     private TelemetryUtils() {
         throw new UnsupportedOperationException("u can't instantiate me...");
     }
@@ -22,6 +28,15 @@ public class TelemetryUtils {
         }
     }

+    public static void sendVideoFullScreenEvent() {
+        try {
+            JSONObject eventData = new JSONObject();
+            eventData.put(KEY_VIDEO_FULL_SCREEN, VALUE_VIDEO_FULL_SCREEN);
+            sendEvent(EVENT_VIDEO_FULL_SCREEN, eventData);
+        } catch (Throwable ignored) {
+        }
+    }
+
     private static void sendEvent(String eventName, JSONObject eventData) {
         Telemetry.send(eventName, eventData);
     }
diff --git a/chrome/android/java/src/org/chromium/chrome/browser/fullscreen/FullscreenHtmlApiHandler.java b/chrome/android/java/src/org/chromium/chrome/browser/fullscreen/FullscreenHtmlApiHandler.java
--- a/chrome/android/java/src/org/chromium/chrome/browser/fullscreen/FullscreenHtmlApiHandler.java
+++ b/chrome/android/java/src/org/chromium/chrome/browser/fullscreen/FullscreenHtmlApiHandler.java
@@ -31,6 +31,7 @@ import org.chromium.base.ApplicationStatus.ActivityStateListener;
 import org.chromium.base.ApplicationStatus.WindowFocusChangedListener;
 import org.chromium.base.Log;
 import org.chromium.base.ObserverList;
+import org.chromium.base.TelemetryUtils;
 import org.chromium.base.supplier.ObservableSupplier;
 import org.chromium.base.supplier.ObservableSupplierImpl;
 import org.chromium.cc.input.BrowserControlsState;
@@ -605,6 +606,8 @@ public class FullscreenHtmlApiHandler implements ActivityStateListener, WindowFo
         mWebContentsInFullscreen = webContents;
         mContentViewInFullscreen = contentView;
         mTabInFullscreen = tab;
+
+        TelemetryUtils.sendVideoFullScreenEvent();
     }

     /**
--
2.17.1