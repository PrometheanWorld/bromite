From: Yifeng <wuyifeng@nd.com.cn>
Date: Fri, 30 Nov 2021 07:23:00 +0000
Subject: The web page forces to fill the screen when the checkbox of Force enable zoom is checked.

This ensures that when the checkbox of Force enable zoom is checked, the web page will not be stretched.
This is the same that when the checkbox is unchecked.
Refer to: https://prometheanworld.atlassian.net/browse/AP9-2791

---
 components/browser_ui/accessibility/android/java/res/xml/accessibility_preferences.xml | 5 -----
 components/browser_ui/accessibility/android/java/src/org/chromium/components/browser_ui/accessibility/AccessibilitySettings.java | 7 -------
 content/browser/web_contents/web_contents_impl.cc | 2 +-
 3 files changed, 1 insertion(+), 13 deletions(-)

diff --git a/components/browser_ui/accessibility/android/java/res/xml/accessibility_preferences.xml b/components/browser_ui/accessibility/android/java/res/xml/accessibility_preferences.xml
--- a/components/browser_ui/accessibility/android/java/res/xml/accessibility_preferences.xml
+++ b/components/browser_ui/accessibility/android/java/res/xml/accessibility_preferences.xml
@@ -26,11 +26,6 @@ found in the LICENSE file.
         android:summary="@string/page_zoom_always_show_preference_summary"
         android:title="@string/page_zoom_always_show_preference_title" />

-    <org.chromium.components.browser_ui.settings.ChromeBaseCheckBoxPreference
-        android:key="force_enable_zoom"
-        android:summary="@string/force_enable_zoom_summary"
-        android:title="@string/force_enable_zoom_title" />
-
     <org.chromium.components.browser_ui.settings.ChromeBaseCheckBoxPreference
         android:key="reader_for_accessibility"
         android:summary="@string/reader_for_accessibility_summary"
diff --git a/components/browser_ui/accessibility/android/java/src/org/chromium/components/browser_ui/accessibility/AccessibilitySettings.java b/components/browser_ui/accessibility/android/java/src/org/chromium/components/browser_ui/accessibility/AccessibilitySettings.java
--- a/components/browser_ui/accessibility/android/java/src/org/chromium/components/browser_ui/accessibility/AccessibilitySettings.java
+++ b/components/browser_ui/accessibility/android/java/src/org/chromium/components/browser_ui/accessibility/AccessibilitySettings.java
@@ -39,7 +39,6 @@ public class AccessibilitySettings
     private TextScalePreference mTextScalePref;
     private PageZoomPreference mPageZoomDefaultZoomPref;
     private ChromeSwitchPreference mPageZoomAlwaysShowPref;
-    private ChromeBaseCheckBoxPreference mForceEnableZoomPref;
     private boolean mRecordFontSizeChangeOnStop;
     private AccessibilitySettingsDelegate mDelegate;
     private BooleanPreferenceDelegate mReaderForAccessibilityDelegate;
@@ -55,7 +54,6 @@ public class AccessibilitySettings

         @Override
         public void onForceEnableZoomChanged(boolean enabled) {
-            mForceEnableZoomPref.setChecked(enabled);
         }
     };

@@ -101,11 +99,6 @@ public class AccessibilitySettings
                     mFontSizePrefs.getUserFontScaleFactor(), false);
         }

-        mForceEnableZoomPref =
-                (ChromeBaseCheckBoxPreference) findPreference(PREF_FORCE_ENABLE_ZOOM);
-        mForceEnableZoomPref.setOnPreferenceChangeListener(this);
-        mForceEnableZoomPref.setChecked(mFontSizePrefs.getForceEnableZoom());
-
         ChromeBaseCheckBoxPreference readerForAccessibilityPref =
                 (ChromeBaseCheckBoxPreference) findPreference(PREF_READER_FOR_ACCESSIBILITY);
         mReaderForAccessibilityDelegate = mDelegate.getReaderForAccessibilityDelegate();
diff --git a/content/browser/web_contents/web_contents_impl.cc b/content/browser/web_contents/web_contents_impl.cc
--- a/content/browser/web_contents/web_contents_impl.cc
+++ b/content/browser/web_contents/web_contents_impl.cc
@@ -2944,7 +2944,7 @@ void WebContentsImpl::OnWebPreferencesChanged() {
     RenderFrameHostImpl* rfh = node->current_frame_host();
     if (rfh->is_local_root()) {
       if (auto* rwh = rfh->GetRenderWidgetHost())
-        rwh->SetForceEnableZoom(web_preferences_->force_enable_zoom);
+        rwh->SetForceEnableZoom(false);
     }
   }
 #endif
--
2.17.1