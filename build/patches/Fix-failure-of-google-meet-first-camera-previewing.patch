From: wuyifeng <wuyifeng@nd.com.cn>
Date: Thu, 5 Jan 2023 16:05:09 +0800
Subject: Fix the issue that the camera preview failed for the first time in Google meet

---
 components/content_settings/core/common/content_settings.cc   | 3 ---
 third_party/blink/renderer/core/html/media/autoplay_policy.cc | 2 --
 2 files changed, 5 deletions(-)

diff --git a/components/content_settings/core/common/content_settings.cc b/components/content_settings/core/common/content_settings.cc
--- a/components/content_settings/core/common/content_settings.cc
+++ b/components/content_settings/core/common/content_settings.cc
@@ -217,7 +217,6 @@ void RendererContentSettingRules::FilterRulesByOutermostMainFrameURL(
   FilterRulesForType(mixed_content_rules, outermost_main_frame_url);
   FilterRulesForType(auto_dark_content_rules, outermost_main_frame_url);
   FilterRulesForType(timezone_override_rules, outermost_main_frame_url);
-  FilterRulesForType(autoplay_rules, outermost_main_frame_url);
 }

 RendererContentSettingRules::RendererContentSettingRules() = default;
diff --git a/third_party/blink/renderer/core/html/media/autoplay_policy.cc b/third_party/blink/renderer/core/html/media/autoplay_policy.cc
--- a/third_party/blink/renderer/core/html/media/autoplay_policy.cc
+++ b/third_party/blink/renderer/core/html/media/autoplay_policy.cc
@@ -311,8 +311,6 @@ void AutoplayPolicy::TryUnlockingUserGesture() {
 }

 bool AutoplayPolicy::IsGestureNeededForPlayback() const {
-  if (!IsAutoplayAllowedPerSettings())
-    return true;
   if (!IsLockedPendingUserGesture())
     return false;

--
2.25.1

